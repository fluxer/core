# Maintainer: Ivailo Monev <xakepa10@gmail.com>

# http://www.linuxfromscratch.org/blfs/view/svn/multimedia/alsa-firmware.html

version=1.0.29
description="ALSA firmware package"
options=('!binaries' '!shared' '!static')
sources=("ftp://ftp.alsa-project.org/pub/firmware/alsa-firmware-$version.tar.bz2")

src_compile() {
    cd "$SOURCE_DIR/alsa-firmware-$version"

    ./configure --prefix=/usr \
        --with-hotplug-dir=/lib/firmware
    make
}

src_install() {
    cd "$SOURCE_DIR/alsa-firmware-$version"

    make DESTDIR="$INSTALL_DIR" install

    # remove files which conflicts with linux-firmware
    rm -vrf "$INSTALL_DIR/lib/firmware/"{ess,korg,sb16,yamaha,ctspeq.bin,ctefx.bin}

    # remove broken symlinks (broken upstream)
    rm -vrf "$INSTALL_DIR/lib/firmware/turtlebeach"
}

