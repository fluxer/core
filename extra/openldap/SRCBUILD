# Maintainer: Ivailo Monev <xakepa10@gmail.com>

# http://www.linuxfromscratch.org/blfs/view/svn/server/openldap.html

version=2.4.48
description="Lightweight Directory Access Protocol (LDAP)"
depends=('libtool' 'cyrus-sasl' 'openssl')
makedepends=('groff')
backup=('etc/openldap/ldap.conf'
        'etc/openldap/slapd.conf'
        'etc/openldap/slapd.ldif')
sources=("ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/openldap-$version.tgz")

src_compile() {
    cd "$SOURCE_DIR/openldap-$version"

    ./configure --prefix=/usr \
        --sysconfdir=/etc     \
        --localstatedir=/var  \
        --libexecdir=/usr/lib     \
        --disable-static      \
        --enable-dynamic      \
        --enable-crypt        \
        --enable-spasswd      \
        --enable-modules      \
        --enable-rlookups     \
        --enable-backends=mod \
        --enable-overlays=mod \
        --disable-ndb         \
        --disable-sql         \
        --disable-slapd
    make -j1 depend
    make -j1
}

src_check() {
    cd "$SOURCE_DIR/openldap-$version"
    make -j1 test
}

src_install() {
    cd "$SOURCE_DIR/openldap-$version"

    make -j1 DESTDIR="$INSTALL_DIR" install

}


