version=1.0.1
description='an elegant unit testing framework for C with support for mock objects'
depends=('musl')
makedepends=('cmake')
sources=("http://git.cryptomilk.org/projects/cmocka.git/snapshot/cmocka-$version.zip")

src_compile() {
    mkdir -p build && cd build
    cmake ../cmocka-$version \
        -DCMAKE_INSTALL_PREFIX=/usr \
        -DCMAKE_BUILD_TYPE=ReWithDbgInfo \
        -DUNIT_TESTING=ON
    make
}

src_check() {
    cd build
    make test
}

src_install() {
    cd build
    make install DESTDIR="$INSTALL_DIR"
}
