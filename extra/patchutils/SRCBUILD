# Maintainer: Ivailo Monev <xakepa10@gmail.com>

version=0.3.4
description="A small collection of programs that operate on patch files"
depends=('musl' 'bash' 'perl')
sources=("http://cyberelk.net/tim/data/patchutils/stable/patchutils-$version.tar.xz"
        "http://cyberelk.net/tim/data/patchutils/stable/patchutils-$version.tar.xz.sig"
        'format-security.patch')
pgpkeys=('B7C20D079491EA63')

src_compile() {
    cd "$SOURCE_DIR/patchutils-$version"

    # FIXME: forwared this to upstream, or just wait for them to find this out
    #        (Fedora is going to use -Wformat -Werror=format-security soon)
    patch -Np0 -i "$SOURCE_DIR/format-security.patch"
    ./configure --prefix=/usr
    make
}

src_check() {
    cd "$SOURCE_DIR/patchutils-$version"
    # FIXME: what the heck provides gendiff???
    make check
}

src_install() {
    cd "$SOURCE_DIR/patchutils-$version"
    make DESTDIR="$INSTALL_DIR" install
}
