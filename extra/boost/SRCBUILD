# Maintainer: Ivailo Monev <xakepa10@gmail.com>

# http://www.linuxfromscratch.org/blfs/view/svn/general/boost.html

version=1_74_0
description="Free peer-reviewed portable C++ source libraries"
makedepends=('gcc' 'python' 'bzip2' 'zlib' 'icu')
sources=("http://downloads.sf.net/boost/boost_$version.tar.bz2")

src_prepare() {
    cd "$SOURCE_DIR/boost_$version"
    sed -e '/using python/ s@;@: /usr/include/python${PYTHON_VERSION/3*/${PYTHON_VERSION}m} ;@' \
        -i bootstrap.sh
}

src_compile() {
    cd "$SOURCE_DIR/boost_$version"

    ./bootstrap.sh --with-toolset=gcc --with-icu
    ./b2 variant=release \
        debug-symbols=off \
        threading=multi \
        runtime-link=shared \
        link=shared \
        toolset=gcc \
        --layout=system \
        --prefix="$INSTALL_DIR/usr" --reconfigure
}


src_install() {
    cd "$SOURCE_DIR/boost_$version"
    ./b2 variant=release \
        debug-symbols=off \
        threading=multi \
        runtime-link=shared \
        link=shared \
        toolset=gcc \
        --layout=system \
        --prefix="$INSTALL_DIR/usr" install
}