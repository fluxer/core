# Maintainer: Ivailo Monev <xakepa10@gmail.com>

# http://www.linuxfromscratch.org/lfs/view/development/chapter06/grep.html

version=2.28
description='A string search utility'
depends=('musl')
optdepends=('pcre')
# makedepends=('texinfo')
sources=("http://ftp.gnu.org/gnu/grep/grep-$version.tar.xz"
         "http://ftp.gnu.org/gnu/grep/grep-$version.tar.xz.sig")
pgpkeys=('155D3FC500C834486D1EEA677FD9FCCB000BEEEE')

src_prepare() {
    cd "$SOURCE_DIR/grep-$version"
    autoreconf -fi
}

src_compile() {
    cd "$SOURCE_DIR/grep-$version"

    _options=" --disable-perl-regexp"
    [ "$OPTIONAL_PCRE" == "yes" ] && _options+=" --enable-perl-regexp"
    ./configure --prefix=/usr \
        --bindir=/bin \
        $_options
    make MAKEINFO=true
}

src_check() {
    cd "$SOURCE_DIR/grep-$version"
    make check
}

src_install() {
    cd "$SOURCE_DIR/grep-$version"
    make DESTDIR=$INSTALL_DIR MAKEINFO=true install
}

